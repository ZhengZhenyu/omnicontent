# OmniContent - ç³»ç»Ÿæ¶æ„è®¾è®¡æ–‡æ¡£

**é¡¹ç›®åç§°**: OmniContent - å…¨åŸŸå†…å®¹ç®¡ç†å¹³å°
**æ–‡æ¡£ç‰ˆæœ¬**: v2.2
**ç¼–å†™æ—¥æœŸ**: 2026-02-06
**æ›´æ–°æ—¥æœŸ**: 2026-02-06 (é¡¹ç›®æ›´åä¸º OmniContent)
**æ¶æ„é£æ ¼**: å‰åç«¯åˆ†ç¦» + å¤šç§Ÿæˆ·SaaSæ¶æ„
**å“ç‰Œå®šä½**: Manage All, Publish Everywhere

---

## 1. æ¶æ„æ¦‚è§ˆ

### 1.1 æ€»ä½“æ¶æ„å›¾

```mermaid
graph TB
    subgraph Client["å®¢æˆ·ç«¯å±‚ (Client Layer)"]
        Browser["Web Browser<br/>(Vue 3 SPA)"]
        Desktop["Desktop<br/>(Electron)"]
        Mobile["Mobile<br/>(æœªæ¥è§„åˆ’)"]
    end

    subgraph Application["åº”ç”¨å±‚ (Application Layer)"]
        subgraph FastAPI["FastAPI Application Server"]
            AuthAPI["Auth API"]
            ContentAPI["Content API"]
            PublishAPI["Publish API"]
            CommunityAPI["Community API"]
            AnalyticsAPI["Analytics API"]
            UserAPI["User API"]
        end

        subgraph Middleware["Middleware Layer"]
            JWT["JWT Authentication"]
            CORS["CORS Policy"]
            Isolation["Community Isolation"]
            ErrorHandler["Error Handler"]
            AuditLog["Audit Logging"]
            RequestID["Request ID Tracking"]
        end
    end

    subgraph Business["ä¸šåŠ¡é€»è¾‘å±‚ (Business Logic Layer)"]
        Converter["Converter Service"]
        WeChat["WeChat Service"]
        Hugo["Hugo Service"]
        CSDN["CSDN Service"]
        Zhihu["Zhihu Service"]
        Scheduler["Scheduler Service"]
    end

    subgraph Data["æ•°æ®å±‚ (Data Layer)"]
        ORM["SQLAlchemy ORM<br/>+ Alembic Migration"]

        subgraph Database["SQLite / PostgreSQL"]
            Tables["communities | users | contents<br/>publish_records | channel_configs | audit_logs"]
        end
    end

    subgraph External["å¤–éƒ¨æœåŠ¡å±‚ (External Services)"]
        WeChatAPI["WeChat Official API"]
        HugoRepo["Hugo Git Repo"]
        CSDNW["CSDN Website"]
        ZhihuW["Zhihu Website"]
        Email["Email Service"]
    end

    subgraph Storage["æ–‡ä»¶å­˜å‚¨å±‚ (Storage Layer)"]
        FileSystem["Local File System<br/>/uploads/files/ - DOCXæ–‡ä»¶<br/>/uploads/images/ - å›¾ç‰‡<br/>/uploads/covers/ - å°é¢å›¾"]
    end

    Browser -->|HTTPS/REST API| FastAPI
    Desktop -->|HTTPS/REST API| FastAPI
    Mobile -->|HTTPS/REST API| FastAPI

    FastAPI --> Middleware
    Middleware --> Business

    Business --> ORM
    ORM --> Database

    Business --> External
    Business --> Storage

    classDef clientStyle fill:#e1f5ff,stroke:#01579b,stroke-width:2px
    classDef appStyle fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef businessStyle fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef dataStyle fill:#e8f5e9,stroke:#1b5e20,stroke-width:2px
    classDef externalStyle fill:#fce4ec,stroke:#880e4f,stroke-width:2px
    classDef storageStyle fill:#fff9c4,stroke:#f57f17,stroke-width:2px

    class Browser,Desktop,Mobile clientStyle
    class FastAPI,Middleware appStyle
    class Converter,WeChat,Hugo,CSDN,Zhihu,Scheduler businessStyle
    class ORM,Database,Tables dataStyle
    class WeChatAPI,HugoRepo,CSDNW,ZhihuW,Email externalStyle
    class FileSystem storageStyle
```

### 1.2 æŠ€æœ¯æ ˆé€‰å‹

| å±‚çº§ | æŠ€æœ¯é€‰å‹ | ç‰ˆæœ¬ | é€‰å‹ç†ç”± |
|------|---------|------|---------|
| **å‰ç«¯æ¡†æ¶** | Vue.js | 3.3+ | æ¸è¿›å¼æ¡†æ¶ï¼Œç”Ÿæ€æˆç†Ÿï¼Œå¼€å‘æ•ˆç‡é«˜ |
| **çŠ¶æ€ç®¡ç†** | Pinia | 2.3+ | Vueå®˜æ–¹æ¨èï¼ŒTypeScriptå‹å¥½ |
| **UIç»„ä»¶åº“** | Element Plus | 2.9+ | ä¼ä¸šçº§ç»„ä»¶åº“ï¼Œæ–‡æ¡£å®Œå–„ |
| **æ—¥å†ç»„ä»¶** | FullCalendar | 6.1+ | åŠŸèƒ½å¼ºå¤§ï¼Œæ”¯æŒæ‹–æ‹½ |
| **çœ‹æ¿æ‹–æ‹½** | vue-draggable-plus | 0.5+ | Vue 3å…¼å®¹ï¼Œæ€§èƒ½ä¼˜ç§€ |
| **å›¾è¡¨åº“** | ECharts | 5.5+ | åŠŸèƒ½å…¨é¢ï¼Œç¤¾åŒºæ´»è·ƒ |
| **Markdownç¼–è¾‘å™¨** | md-editor-v3 | 5.1+ | Vue 3åŸç”Ÿæ”¯æŒï¼Œé¢„è§ˆå®æ—¶ |
| **HTTPå®¢æˆ·ç«¯** | Axios | 1.7+ | æ‹¦æˆªå™¨çµæ´»ï¼Œé”™è¯¯å¤„ç†å®Œå–„ |
| **æ„å»ºå·¥å…·** | Vite | 6.0+ | å¿«é€Ÿå†·å¯åŠ¨ï¼ŒHMRé«˜æ•ˆ |
| **åç«¯æ¡†æ¶** | FastAPI | 0.100+ | å¼‚æ­¥é«˜æ€§èƒ½ï¼Œè‡ªåŠ¨ç”ŸæˆAPIæ–‡æ¡£ |
| **ORM** | SQLAlchemy | 2.0+ | Pythonæœ€æˆç†Ÿçš„ORM |
| **æ•°æ®åº“** | SQLite / PostgreSQL | 3.35+ / 15+ | è½»é‡çº§éƒ¨ç½² / ç”Ÿäº§çº§æ‰©å±• |
| **è¿ç§»å·¥å…·** | Alembic | 1.13+ | SQLAlchemyå®˜æ–¹æ¨è |
| **èº«ä»½è®¤è¯** | PyJWT | 2.8+ | JWTæ ‡å‡†å®ç° |
| **å¯†ç å“ˆå¸Œ** | Passlib + bcrypt | 1.7+ | å®‰å…¨æ€§é«˜ |
| **DOCXå¤„ç†** | python-mammoth | 1.6+ | DOCXâ†’HTMLè½¬æ¢è´¨é‡é«˜ |
| **Markdownæ¸²æŸ“** | python-markdown | 3.5+ | æ‰©å±•æ€§å¼º |
| **ä»»åŠ¡è°ƒåº¦** | APScheduler | 3.10+ | å®šæ—¶å‘å¸ƒåŠŸèƒ½ |

---

## 2. å¤šç§Ÿæˆ·æ¶æ„è®¾è®¡

### 2.1 å¤šç§Ÿæˆ·æ¨¡å¼

é‡‡ç”¨**å…±äº«æ•°æ®åº“ã€å…±äº«Schemaã€æ•°æ®éš”ç¦»**æ¨¡å¼ï¼š

```mermaid
graph TB
    subgraph App["å•ä¸€åº”ç”¨å®ä¾‹ (Single Application Instance)"]
        CommunityA["Community A"]
        CommunityB["Community B"]
        CommunityC["Community C"]

        CommunityA --> ORM
        CommunityB --> ORM
        CommunityC --> ORM

        ORM["ORM Layer<br/>(è‡ªåŠ¨æ·»åŠ  WHERE community_id = ?)"]

        ORM --> DB

        subgraph DB["Shared Database (å…±äº«æ•°æ®åº“)"]
            Contents["ğŸ“Š contents<br/>â”œâ”€ id<br/>â”œâ”€ community_id (FK) â† éš”ç¦»å­—æ®µ<br/>â”œâ”€ title<br/>â””â”€ ..."]
            ChannelConfigs["âš™ï¸ channel_configs<br/>â”œâ”€ id<br/>â”œâ”€ community_id (FK) â† éš”ç¦»å­—æ®µ<br/>â”œâ”€ channel<br/>â””â”€ ..."]
        end
    end

    classDef communityStyle fill:#e3f2fd,stroke:#1976d2,stroke-width:2px
    classDef ormStyle fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef dbStyle fill:#e8f5e9,stroke:#388e3c,stroke-width:2px
    classDef tableStyle fill:#f3e5f5,stroke:#7b1fa2,stroke-width:1px

    class CommunityA,CommunityB,CommunityC communityStyle
    class ORM ormStyle
    class DB dbStyle
    class Contents,ChannelConfigs tableStyle
```

**ä¼˜åŠ¿**:
- âœ… éƒ¨ç½²ç®€å•ï¼Œå•ä¸€å®ä¾‹
- âœ… æˆæœ¬ä½ï¼Œèµ„æºå…±äº«
- âœ… ç»´æŠ¤æ–¹ä¾¿ï¼Œç»Ÿä¸€å‡çº§

**éš”ç¦»æœºåˆ¶**:
- æ‰€æœ‰æŸ¥è¯¢è‡ªåŠ¨æ·»åŠ  `WHERE community_id = ?`
- ä¸­é—´ä»¶å±‚ç»Ÿä¸€æ³¨å…¥community_id
- å¤–é”®çº¦æŸä¿è¯æ•°æ®ä¸€è‡´æ€§

### 2.2 ç§Ÿæˆ·è¯†åˆ«æµç¨‹

```mermaid
sequenceDiagram
    participant Client as å®¢æˆ·ç«¯ (Client)
    participant API as API Server
    participant DB as Database

    Client->>API: 1. HTTP Request<br/>Headers:<br/>â€¢ Authorization: Bearer {token}<br/>â€¢ X-Community-Id: {id}

    rect rgb(240, 248, 255)
        Note over API: 2. Verify JWT Token
        API->>API: get_current_user()<br/>è§£æTokenè·å–user_id
        API->>API: è¿”å› User Object
    end

    rect rgb(255, 245, 240)
        Note over API: 3. Validate Community Access
        API->>API: get_current_community()<br/>æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å±äºè¯¥ç¤¾åŒº<br/>(è¶…ç®¡å¯è®¿é—®æ‰€æœ‰ç¤¾åŒº)
        API->>API: è¿”å› community_id
    end

    rect rgb(240, 255, 240)
        Note over API,DB: 4. Query with Data Isolation
        API->>DB: SELECT * FROM contents<br/>WHERE community_id = ?
        DB-->>API: Filtered Data<br/>(ä»…è¿”å›è¯¥ç¤¾åŒºçš„æ•°æ®)
    end

    API-->>Client: 5. JSON Response<br/>(éš”ç¦»åçš„æ•°æ®)
```

### 2.3 ä¾èµ–æ³¨å…¥å®ç°

```python
# core/dependencies.py

async def get_current_user(
    authorization: str = Header(None),
    db: Session = Depends(get_db)
) -> User:
    """è§£æJWT Tokenï¼Œè¿”å›å½“å‰ç”¨æˆ·"""
    if not authorization or not authorization.startswith("Bearer "):
        raise HTTPException(401, "æœªè®¤è¯")

    token = authorization.replace("Bearer ", "")
    try:
        payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM])
        user_id = payload.get("sub")
    except JWTError:
        raise HTTPException(401, "Tokenæ— æ•ˆ")

    user = db.query(User).filter(User.id == user_id, User.is_active == True).first()
    if not user:
        raise HTTPException(401, "ç”¨æˆ·ä¸å­˜åœ¨")

    return user


async def get_current_community(
    x_community_id: int = Header(None),
    user: User = Depends(get_current_user),
    db: Session = Depends(get_db)
) -> int:
    """éªŒè¯ç”¨æˆ·å¯¹ç¤¾åŒºçš„è®¿é—®æƒé™ï¼Œè¿”å›community_id"""
    if not x_community_id:
        raise HTTPException(400, "ç¼ºå°‘ X-Community-Id è¯·æ±‚å¤´")

    # è¶…çº§ç®¡ç†å‘˜å¯è®¿é—®æ‰€æœ‰ç¤¾åŒº
    if user.is_superuser:
        return x_community_id

    # æ™®é€šç”¨æˆ·éªŒè¯æˆå‘˜å…³ç³»
    membership = db.query(CommunityUser).filter(
        CommunityUser.user_id == user.id,
        CommunityUser.community_id == x_community_id
    ).first()

    if not membership:
        raise HTTPException(403, "æ— æƒè®¿é—®è¯¥ç¤¾åŒº")

    return x_community_id
```

**ä½¿ç”¨ç¤ºä¾‹**:
```python
@router.get("/contents")
def list_contents(
    community_id: int = Depends(get_current_community),
    db: Session = Depends(get_db)
):
    # community_idå·²éªŒè¯ï¼Œç›´æ¥ä½¿ç”¨
    return db.query(Content).filter(Content.community_id == community_id).all()
```

---

## 3. æ•°æ®åº“è®¾è®¡

### 3.1 ERå›¾ï¼ˆEntity Relationship Diagramï¼‰

```mermaid
erDiagram
    communities ||--o{ community_users : "1:N"
    communities ||--o{ contents : "1:N"
    communities ||--o{ channel_configs : "1:N"
    communities ||--o{ audit_logs : "1:N"

    users ||--o{ community_users : "1:N"
    users ||--o{ contents : "creates"
    users ||--o{ audit_logs : "performs"

    contents ||--o{ publish_records : "1:N"
    publish_records ||--o{ content_analytics : "1:N"

    communities {
        int id PK
        string name UK "UNIQUE"
        string slug UK "UNIQUE"
        text description
        string logo_url
        json settings
        boolean is_active
        datetime created_at
        datetime updated_at
    }

    users {
        int id PK
        string username UK "UNIQUE"
        string email UK "UNIQUE"
        string hashed_password
        string full_name
        boolean is_active
        boolean is_superuser
        datetime created_at
    }

    community_users {
        int id PK
        int user_id FK
        int community_id FK
        string role
        datetime joined_at
        string uk_constraint "UNIQUE(user_id, community_id)"
    }

    contents {
        int id PK
        int community_id FK "IDX"
        int created_by_user_id FK "IDX"
        string title
        text content_markdown
        text content_html
        string source_type
        string author
        json tags
        string category
        string cover_image
        string status
        datetime scheduled_publish_at "IDX"
        datetime created_at
        datetime updated_at
    }

    publish_records {
        int id PK
        int content_id FK "IDX"
        string channel
        string status
        string platform_id
        string platform_url
        datetime published_at
        text error_message
        datetime created_at
    }

    content_analytics {
        int id PK
        int publish_record_id FK
        int read_count
        int like_count
        int share_count
        int comment_count
        datetime collected_at
    }

    channel_configs {
        int id PK
        int community_id FK
        string channel
        json config
        boolean enabled
        string uk_constraint "UNIQUE(community_id, channel)"
    }

    audit_logs {
        int id PK
        int user_id FK
        int community_id FK
        string action
        string resource_type
        int resource_id
        json details
        string ip_address
        datetime created_at "IDX"
    }
```

### 3.2 ç´¢å¼•è®¾è®¡

| è¡¨å | ç´¢å¼•å­—æ®µ | ç´¢å¼•ç±»å‹ | ç”¨é€” |
|------|---------|---------|------|
| users | username | UNIQUE | ç™»å½•æŸ¥è¯¢ |
| users | email | UNIQUE | é‚®ç®±å”¯ä¸€ |
| communities | slug | UNIQUE | URLå‹å¥½æ ‡è¯† |
| community_users | (user_id, community_id) | UNIQUE | é˜²æ­¢é‡å¤åŠ å…¥ |
| contents | community_id | BTREE | ç¤¾åŒºæŸ¥è¯¢ï¼ˆæœ€é¢‘ç¹ï¼‰ |
| contents | created_by_user_id | BTREE | ä½œè€…æŸ¥è¯¢ |
| contents | scheduled_publish_at | BTREE | æ—¥å†è§†å›¾æŸ¥è¯¢ |
| contents | (community_id, status) | COMPOSITE | çœ‹æ¿è§†å›¾æŸ¥è¯¢ |
| channel_configs | (community_id, channel) | UNIQUE | é…ç½®æŸ¥è¯¢ |
| audit_logs | created_at | BTREE | æ—¶é—´èŒƒå›´æŸ¥è¯¢ |
| audit_logs | (user_id, created_at) | COMPOSITE | ç”¨æˆ·æ“ä½œå†å² |

### 3.3 åˆ†åŒºç­–ç•¥ï¼ˆæœªæ¥æ‰©å±•ï¼‰

å½“audit_logsè¡¨è¶…è¿‡100ä¸‡æ¡è®°å½•æ—¶ï¼Œè€ƒè™‘æŒ‰æ—¶é—´åˆ†åŒºï¼š

```sql
-- PostgreSQLç¤ºä¾‹
CREATE TABLE audit_logs (
    id SERIAL,
    created_at TIMESTAMP NOT NULL,
    ...
) PARTITION BY RANGE (created_at);

CREATE TABLE audit_logs_2026_q1 PARTITION OF audit_logs
    FOR VALUES FROM ('2026-01-01') TO ('2026-04-01');

CREATE TABLE audit_logs_2026_q2 PARTITION OF audit_logs
    FOR VALUES FROM ('2026-04-01') TO ('2026-07-01');
```

---

## 4. APIè®¾è®¡

### 4.1 APIè®¾è®¡åŸåˆ™

- **RESTfulé£æ ¼**: èµ„æºå®šä½ä½¿ç”¨åè¯ï¼Œæ“ä½œä½¿ç”¨HTTPæ–¹æ³•
- **ç»Ÿä¸€å“åº”æ ¼å¼**: æˆåŠŸè¿”å›200/201ï¼Œé”™è¯¯è¿”å›4xx/5xx + detail
- **ç‰ˆæœ¬æ§åˆ¶**: è·¯å¾„åŠ /v1å‰ç¼€ï¼ˆæœªæ¥æ‰©å±•ï¼‰
- **åˆ†é¡µæ ‡å‡†**: `page`å’Œ`page_size`å‚æ•°
- **è¿‡æ»¤æ ‡å‡†**: æŸ¥è¯¢å‚æ•°ï¼Œå¦‚`?status=draft&keyword=kubernetes`

### 4.2 APIç«¯ç‚¹æ€»è§ˆ

| æ¨¡å— | æ–¹æ³• | è·¯å¾„ | æè¿° |
|------|------|------|------|
| **è®¤è¯** | POST | /api/auth/login | ç™»å½• |
| | GET | /api/auth/me | è·å–å½“å‰ç”¨æˆ· |
| **ç¤¾åŒº** | GET | /api/communities | ç¤¾åŒºåˆ—è¡¨ |
| | POST | /api/communities | åˆ›å»ºç¤¾åŒºï¼ˆè¶…ç®¡ï¼‰ |
| | GET | /api/communities/{id} | ç¤¾åŒºè¯¦æƒ… |
| | PUT | /api/communities/{id} | æ›´æ–°ç¤¾åŒº |
| | DELETE | /api/communities/{id} | åˆ é™¤ç¤¾åŒº |
| | POST | /api/communities/{id}/users | æ·»åŠ æˆå‘˜ |
| | DELETE | /api/communities/{id}/users/{uid} | ç§»é™¤æˆå‘˜ |
| **å†…å®¹** | GET | /api/contents | å†…å®¹åˆ—è¡¨ï¼ˆåˆ†é¡µï¼‰ |
| | POST | /api/contents | åˆ›å»ºå†…å®¹ |
| | GET | /api/contents/{id} | å†…å®¹è¯¦æƒ… |
| | PUT | /api/contents/{id} | æ›´æ–°å†…å®¹ |
| | DELETE | /api/contents/{id} | åˆ é™¤å†…å®¹ |
| | PATCH | /api/contents/{id}/status | æ›´æ–°çŠ¶æ€ |
| | PATCH | /api/contents/{id}/schedule | è®¾ç½®è®¡åˆ’æ—¶é—´ |
| | GET | /api/contents/calendar | æ—¥å†æ•°æ® |
| | GET | /api/contents/kanban | çœ‹æ¿æ•°æ® |
| | POST | /api/contents/batch-update-status | æ‰¹é‡æ›´æ–°çŠ¶æ€ |
| **ä¸Šä¼ ** | POST | /api/contents/upload | ä¸Šä¼ DOCX/MD |
| | POST | /api/contents/{id}/cover | ä¸Šä¼ å°é¢å›¾ |
| **å‘å¸ƒ** | POST | /api/publish/{id}/wechat | å‘å¸ƒåˆ°å¾®ä¿¡ |
| | POST | /api/publish/{id}/hugo | å‘å¸ƒåˆ°Hugo |
| | GET | /api/publish/{id}/preview/{channel} | é¢„è§ˆ |
| | GET | /api/publish/{id}/copy/{channel} | è·å–å¤åˆ¶å†…å®¹ |
| | GET | /api/publish/records | å‘å¸ƒè®°å½• |
| **åˆ†æ** | GET | /api/analytics/overview | æ¦‚è§ˆç»Ÿè®¡ |
| | GET | /api/analytics/dashboard | ä»ªè¡¨æ¿æ•°æ® |
| | GET | /api/analytics/by-channel | æŒ‰æ¸ é“ç»Ÿè®¡ |
| | GET | /api/analytics/by-author | æŒ‰ä½œè€…ç»Ÿè®¡ |
| | GET | /api/analytics/trend | è¶‹åŠ¿æ•°æ® |
| | GET | /api/analytics/category-distribution | åˆ†ç±»åˆ†å¸ƒ |
| | GET | /api/analytics/settings/channels | æ¸ é“é…ç½®åˆ—è¡¨ |
| | PUT | /api/analytics/settings/channels/{ch} | æ›´æ–°æ¸ é“é…ç½® |

### 4.3 è¯·æ±‚/å“åº”ç¤ºä¾‹

#### ç™»å½•è¯·æ±‚
```http
POST /api/auth/login
Content-Type: application/json

{
  "username": "admin",
  "password": "admin123"
}
```

**å“åº”**:
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer"
}
```

#### å†…å®¹åˆ—è¡¨è¯·æ±‚ï¼ˆå¸¦ç¤¾åŒºéš”ç¦»ï¼‰
```http
GET /api/contents?page=1&page_size=20&status=draft&keyword=k8s
Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
X-Community-Id: 5
```

**å“åº”**:
```http
HTTP/1.1 200 OK
Content-Type: application/json

{
  "items": [
    {
      "id": 123,
      "title": "Kubernetes 1.28 Release Note",
      "status": "draft",
      "author": "å¼ ä¸‰",
      "created_at": "2026-02-01T10:00:00Z"
    }
  ],
  "total": 45,
  "page": 1,
  "page_size": 20
}
```

### 4.4 é”™è¯¯ç è§„èŒƒ

| HTTPçŠ¶æ€ç  | é”™è¯¯ç±»å‹ | ç¤ºä¾‹åœºæ™¯ |
|-----------|---------|---------|
| 400 | Bad Request | å‚æ•°æ ¡éªŒå¤±è´¥ã€ç¼ºå°‘å¿…å¡«å­—æ®µ |
| 401 | Unauthorized | Tokenæ— æ•ˆæˆ–è¿‡æœŸ |
| 403 | Forbidden | æ— æƒè®¿é—®è¯¥ç¤¾åŒº |
| 404 | Not Found | èµ„æºä¸å­˜åœ¨ |
| 409 | Conflict | ç¤¾åŒºslugé‡å¤ |
| 422 | Unprocessable Entity | ä¸šåŠ¡é€»è¾‘é”™è¯¯ï¼ˆå¦‚çŠ¶æ€æµè½¬ä¸åˆæ³•ï¼‰ |
| 500 | Internal Server Error | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |
| 502 | Bad Gateway | å¤–éƒ¨APIè°ƒç”¨å¤±è´¥ï¼ˆå¦‚å¾®ä¿¡APIï¼‰ |

**é”™è¯¯å“åº”æ ¼å¼**:
```json
{
  "detail": "æ— æƒè®¿é—®è¯¥ç¤¾åŒº"
}
```

---

## 5. å‰ç«¯æ¶æ„è®¾è®¡

### 5.1 ç»„ä»¶å±‚æ¬¡ç»“æ„

```
src/
â”œâ”€â”€ main.ts                      # åº”ç”¨å…¥å£
â”œâ”€â”€ App.vue                      # æ ¹ç»„ä»¶
â”‚
â”œâ”€â”€ router/
â”‚   â””â”€â”€ index.ts                 # è·¯ç”±é…ç½®
â”‚
â”œâ”€â”€ stores/                      # PiniaçŠ¶æ€ç®¡ç†
â”‚   â”œâ”€â”€ auth.ts                  # è®¤è¯çŠ¶æ€
â”‚   â”œâ”€â”€ community.ts             # ç¤¾åŒºä¸Šä¸‹æ–‡
â”‚   â””â”€â”€ content.ts               # å†…å®¹ç¼“å­˜ï¼ˆå¯é€‰ï¼‰
â”‚
â”œâ”€â”€ api/                         # APIå®¢æˆ·ç«¯
â”‚   â”œâ”€â”€ index.ts                 # Axioså®ä¾‹é…ç½®
â”‚   â”œâ”€â”€ auth.ts                  # è®¤è¯API
â”‚   â”œâ”€â”€ community.ts             # ç¤¾åŒºAPI
â”‚   â”œâ”€â”€ content.ts               # å†…å®¹API
â”‚   â”œâ”€â”€ publish.ts               # å‘å¸ƒAPI
â”‚   â””â”€â”€ analytics.ts             # åˆ†æAPI
â”‚
â”œâ”€â”€ views/                       # é¡µé¢ç»„ä»¶
â”‚   â”œâ”€â”€ Login.vue                # ç™»å½•é¡µ
â”‚   â”œâ”€â”€ Dashboard.vue            # ä»ªè¡¨æ¿
â”‚   â”œâ”€â”€ ContentList.vue          # å†…å®¹åˆ—è¡¨
â”‚   â”œâ”€â”€ ContentEdit.vue          # å†…å®¹ç¼–è¾‘
â”‚   â”œâ”€â”€ ContentCalendar.vue      # æ—¥å†è§†å›¾ â­
â”‚   â”œâ”€â”€ ContentKanban.vue        # çœ‹æ¿è§†å›¾ â­
â”‚   â”œâ”€â”€ PublishView.vue          # å‘å¸ƒç®¡ç†
â”‚   â”œâ”€â”€ AnalyticsDashboard.vue   # æ•°æ®åˆ†æ â­
â”‚   â”œâ”€â”€ Settings.vue             # è®¾ç½®
â”‚   â”œâ”€â”€ CommunityManage.vue      # ç¤¾åŒºç®¡ç†
â”‚   â””â”€â”€ UserProfile.vue          # ç”¨æˆ·èµ„æ–™
â”‚
â”œâ”€â”€ components/                  # å¯å¤ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ CommunitySwitcher.vue    # ç¤¾åŒºåˆ‡æ¢å™¨ â­
â”‚   â”œâ”€â”€ CalendarEventDialog.vue  # æ—¥å†äº‹ä»¶å¯¹è¯æ¡† â­
â”‚   â”œâ”€â”€ KanbanCard.vue           # çœ‹æ¿å¡ç‰‡ â­
â”‚   â””â”€â”€ ChartCard.vue            # å›¾è¡¨å®¹å™¨ â­
â”‚
â”œâ”€â”€ composables/                 # ç»„åˆå¼å‡½æ•°
â”‚   â”œâ”€â”€ useAuth.ts               # è®¤è¯é€»è¾‘
â”‚   â”œâ”€â”€ useCommunity.ts          # ç¤¾åŒºé€»è¾‘
â”‚   â””â”€â”€ usePermission.ts         # æƒé™åˆ¤æ–­
â”‚
â””â”€â”€ assets/                      # é™æ€èµ„æº
    â”œâ”€â”€ calendar.scss            # æ—¥å†æ ·å¼ â­
    â”œâ”€â”€ kanban.scss              # çœ‹æ¿æ ·å¼ â­
    â””â”€â”€ analytics.scss           # åˆ†ææ ·å¼ â­
```

### 5.2 çŠ¶æ€ç®¡ç†è®¾è®¡

#### auth.ts (è®¤è¯çŠ¶æ€)
```typescript
export const useAuthStore = defineStore('auth', () => {
  // State
  const token = ref<string | null>(localStorage.getItem('token'))
  const user = ref<User | null>(null)
  const communities = ref<Community[]>([])

  // Getters
  const isAuthenticated = computed(() => !!token.value && !!user.value)
  const isSuperuser = computed(() => user.value?.is_superuser === true)

  // Actions
  async function login(username: string, password: string) {
    const response = await api.post('/auth/login', { username, password })
    token.value = response.data.access_token
    localStorage.setItem('token', token.value!)
    await fetchUserInfo()
  }

  async function fetchUserInfo() {
    const response = await api.get('/auth/me')
    user.value = response.data.user
    communities.value = response.data.communities
  }

  function logout() {
    token.value = null
    user.value = null
    communities.value = []
    localStorage.removeItem('token')
    router.push('/login')
  }

  return { token, user, communities, isAuthenticated, isSuperuser, login, fetchUserInfo, logout }
})
```

#### community.ts (ç¤¾åŒºä¸Šä¸‹æ–‡)
```typescript
export const useCommunityStore = defineStore('community', () => {
  // State
  const currentCommunityId = ref<number | null>(
    parseInt(localStorage.getItem('currentCommunityId') || '0') || null
  )

  // Getters
  const hasSelectedCommunity = computed(() => currentCommunityId.value !== null)

  // Actions
  function setCommunity(id: number) {
    currentCommunityId.value = id
    localStorage.setItem('currentCommunityId', String(id))
  }

  function clearCommunity() {
    currentCommunityId.value = null
    localStorage.removeItem('currentCommunityId')
  }

  return { currentCommunityId, hasSelectedCommunity, setCommunity, clearCommunity }
})
```

### 5.3 è·¯ç”±å®ˆå«è®¾è®¡

```typescript
// router/index.ts

router.beforeEach(async (to, from, next) => {
  const authStore = useAuthStore()
  const communityStore = useCommunityStore()

  // 1. æ£€æŸ¥è®¤è¯
  if (to.meta.requiresAuth && !authStore.isAuthenticated) {
    return next('/login')
  }

  // 2. æ£€æŸ¥ç¤¾åŒºé€‰æ‹©
  if (to.meta.requiresCommunity && !communityStore.hasSelectedCommunity) {
    ElMessage.warning('è¯·å…ˆé€‰æ‹©ç¤¾åŒº')
    return next('/dashboard')
  }

  // 3. æ£€æŸ¥è¶…ç®¡æƒé™
  if (to.meta.requiresSuperuser && !authStore.isSuperuser) {
    ElMessage.error('éœ€è¦è¶…çº§ç®¡ç†å‘˜æƒé™')
    return next('/dashboard')
  }

  // 4. å·²ç™»å½•ç”¨æˆ·è®¿é—®ç™»å½•é¡µï¼Œè·³è½¬åˆ°é¦–é¡µ
  if (to.path === '/login' && authStore.isAuthenticated) {
    return next('/dashboard')
  }

  next()
})
```

### 5.4 Axiosæ‹¦æˆªå™¨

```typescript
// api/index.ts

// è¯·æ±‚æ‹¦æˆªå™¨
api.interceptors.request.use(config => {
  const authStore = useAuthStore()
  const communityStore = useCommunityStore()

  // æ·»åŠ Authorizationå¤´
  if (authStore.token) {
    config.headers.Authorization = `Bearer ${authStore.token}`
  }

  // æ·»åŠ X-Community-Idå¤´ï¼ˆé™¤äº†ç™»å½•ã€ç¤¾åŒºåˆ—è¡¨ç­‰å…¬å…±APIï¼‰
  if (communityStore.currentCommunityId && !config.url?.includes('/auth/')) {
    config.headers['X-Community-Id'] = String(communityStore.currentCommunityId)
  }

  return config
})

// å“åº”æ‹¦æˆªå™¨
api.interceptors.response.use(
  response => response,
  error => {
    if (error.response?.status === 401) {
      // Tokenè¿‡æœŸæˆ–æ— æ•ˆï¼Œæ¸…ç©ºçŠ¶æ€å¹¶è·³è½¬ç™»å½•
      const authStore = useAuthStore()
      authStore.logout()
      ElMessage.error('ç™»å½•å·²è¿‡æœŸï¼Œè¯·é‡æ–°ç™»å½•')
    } else if (error.response?.status === 403) {
      ElMessage.error('æ— æƒè®¿é—®è¯¥èµ„æº')
    }
    return Promise.reject(error)
  }
)
```

---

## 6. å®‰å…¨æ¶æ„è®¾è®¡

### 6.1 è®¤è¯æµç¨‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Client â”‚           â”‚   API    â”‚           â”‚   DB     â”‚
â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
    â”‚                     â”‚                      â”‚
    â”‚  1. POST /auth/login                      â”‚
    â”‚  {username, password}                     â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                      â”‚
    â”‚                     â”‚  2. Query user       â”‚
    â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                     â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                     â”‚  User record         â”‚
    â”‚                     â”‚                      â”‚
    â”‚                     â”‚  3. Verify password  â”‚
    â”‚                     â”‚  (bcrypt.verify)     â”‚
    â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”               â”‚
    â”‚                     â”‚      â”‚               â”‚
    â”‚                     â”‚<â”€â”€â”€â”€â”€â”˜               â”‚
    â”‚                     â”‚                      â”‚
    â”‚                     â”‚  4. Create JWT       â”‚
    â”‚                     â”‚  payload: {sub: id}  â”‚
    â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”               â”‚
    â”‚                     â”‚      â”‚               â”‚
    â”‚                     â”‚<â”€â”€â”€â”€â”€â”˜               â”‚
    â”‚  5. Return Token    â”‚                      â”‚
    â”‚  {access_token}     â”‚                      â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚
    â”‚                     â”‚                      â”‚
    â”‚  6. Store Token     â”‚                      â”‚
    â”‚  (localStorage)     â”‚                      â”‚
    â”‚â”€â”€â”€â”€â”€â”€â”              â”‚                      â”‚
    â”‚      â”‚              â”‚                      â”‚
    â”‚<â”€â”€â”€â”€â”€â”˜              â”‚                      â”‚
    â”‚                     â”‚                      â”‚
    â”‚  7. API Request     â”‚                      â”‚
    â”‚  Header: Bearer {token}                   â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                      â”‚
    â”‚                     â”‚  8. Verify JWT       â”‚
    â”‚                     â”‚â”€â”€â”€â”€â”€â”€â”               â”‚
    â”‚                     â”‚      â”‚               â”‚
    â”‚                     â”‚<â”€â”€â”€â”€â”€â”˜               â”‚
    â”‚  9. Success         â”‚                      â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                      â”‚
```

### 6.2 å¯†ç å®‰å…¨

- **å“ˆå¸Œç®—æ³•**: bcryptï¼ˆæˆæœ¬å› å­12ï¼‰
- **ç›å€¼**: è‡ªåŠ¨ç”Ÿæˆï¼ˆbcryptå†…ç½®ï¼‰
- **å­˜å‚¨**: ä»…å­˜å‚¨å“ˆå¸Œå€¼ï¼ŒåŸå§‹å¯†ç ä¸å¯æ¢å¤
- **å¯†ç ç­–ç•¥**: æœ€å°‘8ä½ï¼ŒåŒ…å«å­—æ¯+æ•°å­—ï¼ˆå‰ç«¯éªŒè¯ï¼‰

### 6.3 JWT Tokenè®¾è®¡

**Payload**:
```json
{
  "sub": "1",                    // ç”¨æˆ·ID
  "exp": 1738934400,             // è¿‡æœŸæ—¶é—´ï¼ˆ7å¤©åï¼‰
  "iat": 1738329600              // ç­¾å‘æ—¶é—´
}
```

**å®‰å…¨æªæ–½**:
- HTTPSä¼ è¾“
- HttpOnly Cookieï¼ˆå¯é€‰ï¼Œå½“å‰ä½¿ç”¨localStorageï¼‰
- çŸ­æœŸæœ‰æ•ˆï¼ˆ7å¤©ï¼‰
- æ— åˆ·æ–°Tokenï¼ˆç®€åŒ–å®ç°ï¼‰

### 6.4 CORSç­–ç•¥

```python
# main.py
app.add_middleware(
    CORSMiddleware,
    allow_origins=["http://localhost:5173"],  # å¼€å‘ç¯å¢ƒ
    # allow_origins=["https://yourdomain.com"],  # ç”Ÿäº§ç¯å¢ƒ
    allow_credentials=True,
    allow_methods=["*"],
    allow_headers=["*"],
)
```

### 6.5 è¾“å…¥éªŒè¯

- **å‰ç«¯éªŒè¯**: Element Plusè¡¨å•éªŒè¯
- **åç«¯éªŒè¯**: Pydantic Schemaå¼ºç±»å‹éªŒè¯
- **SQLæ³¨å…¥é˜²æŠ¤**: SQLAlchemy ORMå‚æ•°åŒ–æŸ¥è¯¢
- **XSSé˜²æŠ¤**: Markdownæ¸²æŸ“æ—¶è½¬ä¹‰HTMLæ ‡ç­¾

---

## 7. æ€§èƒ½ä¼˜åŒ–è®¾è®¡

### 7.1 æ•°æ®åº“ä¼˜åŒ–

| ä¼˜åŒ–é¡¹ | ç­–ç•¥ |
|--------|------|
| ç´¢å¼•ä¼˜åŒ– | é«˜é¢‘æŸ¥è¯¢å­—æ®µå»ºç«‹ç´¢å¼•ï¼ˆcommunity_idã€statusï¼‰ |
| åˆ†é¡µæŸ¥è¯¢ | LIMIT + OFFSETï¼Œé¿å…å…¨è¡¨æ‰«æ |
| N+1é—®é¢˜ | ä½¿ç”¨joinedloadé¢„åŠ è½½å…³è”æ•°æ® |
| è¿æ¥æ±  | SQLAlchemyè¿æ¥æ± ï¼ˆé»˜è®¤5ä¸ªï¼‰ |
| æŸ¥è¯¢ä¼˜åŒ– | SELECTä»…æŸ¥è¯¢éœ€è¦çš„å­—æ®µï¼Œé¿å…SELECT * |

### 7.2 å‰ç«¯æ€§èƒ½ä¼˜åŒ–

| ä¼˜åŒ–é¡¹ | ç­–ç•¥ |
|--------|------|
| ä»£ç åˆ†å‰² | è·¯ç”±æ‡’åŠ è½½ï¼ˆ() => import()ï¼‰ |
| å›¾ç‰‡æ‡’åŠ è½½ | vue-lazyloadæ’ä»¶ |
| é˜²æŠ–èŠ‚æµ | æœç´¢æ¡†300msé˜²æŠ– |
| è™šæ‹Ÿæ»šåŠ¨ | é•¿åˆ—è¡¨ä½¿ç”¨vue-virtual-scroller |
| CDNåŠ é€Ÿ | Element Pluså›¾æ ‡åº“ä½¿ç”¨CDN |
| ç¼“å­˜ç­–ç•¥ | Axiosç¼“å­˜GETè¯·æ±‚ç»“æœï¼ˆ5åˆ†é’Ÿï¼‰ |

### 7.3 ç¼“å­˜ç­–ç•¥

```python
from functools import lru_cache

@lru_cache(maxsize=100)
def get_community_config(community_id: int, channel: str) -> dict:
    """ç¼“å­˜ç¤¾åŒºé…ç½®ï¼Œå‡å°‘æ•°æ®åº“æŸ¥è¯¢"""
    return db.query(ChannelConfig).filter(...).first()
```

### 7.4 å¼‚æ­¥å¤„ç†

```python
# å¾®ä¿¡APIè°ƒç”¨ä½¿ç”¨å¼‚æ­¥
async def create_draft(title: str, content: str):
    async with httpx.AsyncClient() as client:
        response = await client.post(url, json=data)
        return response.json()
```

---

## 8. éƒ¨ç½²æ¶æ„

### 8.1 å¼€å‘ç¯å¢ƒ

```
Developer Machine
â”œâ”€â”€ Backend (localhost:8000)
â”‚   â””â”€â”€ uvicorn --reload
â”œâ”€â”€ Frontend (localhost:5173)
â”‚   â””â”€â”€ npm run dev
â””â”€â”€ SQLite (./content_hub.db)
```

### 8.2 ç”Ÿäº§ç¯å¢ƒï¼ˆDocker Composeï¼‰

```yaml
version: '3.8'

services:
  backend:
    image: content-hub-backend:latest
    environment:
      - DATABASE_URL=postgresql://user:pass@postgres/content_hub
      - JWT_SECRET_KEY=${JWT_SECRET_KEY}
    depends_on:
      - postgres
    volumes:
      - ./uploads:/app/uploads

  frontend:
    image: content-hub-frontend:latest
    ports:
      - "80:80"

  postgres:
    image: postgres:15
    environment:
      - POSTGRES_DB=content_hub
      - POSTGRES_USER=admin
      - POSTGRES_PASSWORD=${DB_PASSWORD}
    volumes:
      - postgres_data:/var/lib/postgresql/data

volumes:
  postgres_data:
```

### 8.3 æ‰©å±•æ¶æ„ï¼ˆæœªæ¥ï¼‰

```mermaid
graph TB
    LB[Nginx Load Balancer]

    LB --> Backend1[FastAPI Backend 1]
    LB --> Backend2[FastAPI Backend 2]
    LB --> Backend3[FastAPI Backend 3]

    Backend1 --> Master
    Backend2 --> Master
    Backend3 --> Master

    Master[PostgreSQL Master<br/>è¯»å†™]
    Master -->|Replication| Replica[PostgreSQL Replica<br/>åªè¯»]

    subgraph Cluster["åº”ç”¨é›†ç¾¤ (Application Cluster)"]
        Backend1
        Backend2
        Backend3
    end

    subgraph DBCluster["æ•°æ®åº“é›†ç¾¤ (Database Cluster)"]
        Master
        Replica
    end

    classDef lbStyle fill:#ff9800,stroke:#e65100,stroke-width:3px,color:#fff
    classDef backendStyle fill:#42a5f5,stroke:#1976d2,stroke-width:2px,color:#fff
    classDef masterStyle fill:#66bb6a,stroke:#2e7d32,stroke-width:2px,color:#fff
    classDef replicaStyle fill:#9ccc65,stroke:#558b2f,stroke-width:2px,color:#fff

    class LB lbStyle
    class Backend1,Backend2,Backend3 backendStyle
    class Master masterStyle
    class Replica replicaStyle
```

---

## 9. ç›‘æ§ä¸æ—¥å¿—

### 9.1 æ—¥å¿—è®¾è®¡

**æ—¥å¿—çº§åˆ«**:
- DEBUG: è¯¦ç»†è°ƒè¯•ä¿¡æ¯ï¼ˆå¼€å‘ç¯å¢ƒï¼‰
- INFO: å…³é”®ä¸šåŠ¡æµç¨‹ï¼ˆç™»å½•ã€å‘å¸ƒï¼‰
- WARNING: æ½œåœ¨é—®é¢˜ï¼ˆTokenå³å°†è¿‡æœŸï¼‰
- ERROR: é”™è¯¯ä½†ä¸å½±å“æœåŠ¡ï¼ˆå¤–éƒ¨APIè°ƒç”¨å¤±è´¥ï¼‰
- CRITICAL: ä¸¥é‡é”™è¯¯ï¼ˆæ•°æ®åº“è¿æ¥å¤±è´¥ï¼‰

**æ—¥å¿—æ ¼å¼**ï¼ˆJSONï¼‰:
```json
{
  "timestamp": "2026-02-06T10:30:00Z",
  "level": "INFO",
  "logger": "app.api.publish",
  "message": "å‘å¸ƒåˆ°å¾®ä¿¡æˆåŠŸ",
  "extra": {
    "user_id": 5,
    "community_id": 2,
    "content_id": 123,
    "channel": "wechat",
    "duration_ms": 2500
  }
}
```

### 9.2 ç›‘æ§æŒ‡æ ‡

| æŒ‡æ ‡ç±»å‹ | å…·ä½“æŒ‡æ ‡ | å‘Šè­¦é˜ˆå€¼ |
|---------|---------|---------|
| **ç³»ç»ŸæŒ‡æ ‡** | CPUä½¿ç”¨ç‡ | >80% |
| | å†…å­˜ä½¿ç”¨ç‡ | >85% |
| | ç£ç›˜ä½¿ç”¨ç‡ | >90% |
| **åº”ç”¨æŒ‡æ ‡** | APIå“åº”æ—¶é—´P95 | >1s |
| | é”™è¯¯ç‡ | >5% |
| | å¹¶å‘è¯·æ±‚æ•° | >100 |
| **ä¸šåŠ¡æŒ‡æ ‡** | ç™»å½•å¤±è´¥ç‡ | >10% |
| | å‘å¸ƒæˆåŠŸç‡ | <95% |
| | æ—¥æ´»ç”¨æˆ·æ•° | è¶‹åŠ¿ä¸‹é™ |

### 9.3 å®¡è®¡æ—¥å¿—æŸ¥è¯¢

```sql
-- æŸ¥è¯¢æŸç”¨æˆ·æœ€è¿‘çš„æ“ä½œ
SELECT action, resource_type, resource_id, created_at
FROM audit_logs
WHERE user_id = 5
ORDER BY created_at DESC
LIMIT 50;

-- æŸ¥è¯¢æŸç¤¾åŒºçš„å‘å¸ƒæ“ä½œ
SELECT u.username, al.action, al.details, al.created_at
FROM audit_logs al
JOIN users u ON al.user_id = u.id
WHERE al.community_id = 2
  AND al.action LIKE 'publish_%'
ORDER BY al.created_at DESC;
```

---

## 10. æŠ€æœ¯å€ºåŠ¡ä¸æ”¹è¿›è®¡åˆ’

### 10.1 å½“å‰æŠ€æœ¯å€ºåŠ¡

| å€ºåŠ¡é¡¹ | å½±å“ | è¿˜å€ºè®¡åˆ’ |
|--------|------|---------|
| SQLiteå¹¶å‘é™åˆ¶ | ä¸­ | Phase 5è¿ç§»PostgreSQL |
| ç¼ºå°‘å•å…ƒæµ‹è¯• | é«˜ | Phase 5è¡¥å……æµ‹è¯•ï¼ˆè¦†ç›–ç‡>80%ï¼‰ |
| å‰ç«¯çŠ¶æ€ç®¡ç†ç®€å• | ä½ | æŒ‰éœ€ä¼˜åŒ–ï¼ˆVuex â†’ Piniaå·²å®Œæˆï¼‰ |
| ç¼ºå°‘CI/CD | ä¸­ | Phase 6é›†æˆGitHub Actions |
| å®¡è®¡æ—¥å¿—æ— æ£€ç´¢UI | ä½ | Phase 6å¼€å‘å®¡è®¡æ—¥å¿—æŸ¥è¯¢é¡µé¢ |

### 10.2 æ¶æ„æ¼”è¿›è·¯çº¿

```
Phase 1-4: å¤šç§Ÿæˆ·åŸºç¡€æ¶æ„                    [å½“å‰é˜¶æ®µ]
    â†“
Phase 5: PostgreSQLè¿ç§» + å•å…ƒæµ‹è¯•          [Q2 2026]
    â†“
Phase 6: CI/CD + ç›‘æ§å‘Šè­¦ + å®¡è®¡æ—¥å¿—UI      [Q3 2026]
    â†“
Phase 7: RBACæƒé™ä½“ç³» + å·¥ä½œæµå¼•æ“          [Q4 2026]
    â†“
Phase 8: ç§»åŠ¨ç«¯é€‚é… + å¤šè¯­è¨€æ”¯æŒ            [2027]
```

---

**æ–‡æ¡£çŠ¶æ€**: âœ… å·²è¯„å®¡é€šè¿‡
**è¯„å®¡äºº**: æ¶æ„å¸ˆã€æŠ€æœ¯è´Ÿè´£äºº
**è¯„å®¡æ—¥æœŸ**: 2026-02-06
